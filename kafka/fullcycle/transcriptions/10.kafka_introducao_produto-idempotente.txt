Olá pessoal, tudo bem? Agora a gente vai falar sobre um nome muito bacana, né? A gente vai falar sobre indepotência, né? A gente vai falar sobre o produtor indepotente, né? O que que isso significa? Pra que que serve? Vamos tentar entender como é que funciona essa história aqui, tá? Isso é importante. Seguinte, Vamos imaginar que a gente tem essa situação, deixa eu tentar explicar aqui. Eu tenho um producer, ele vai mandar mensagem pro broker, legal? Então o que que acontece? Ele manda a mensagem 1, legal? O broker retorna ali pra ele falando que ok, né? Deu um EC. Mandou a mensagem 2, recebeu um EC. Mandou a mensagem 3, recebeu um EC. O grande ponto é que na hora que ele mandou a mensagem 4, Adivinha o que que aconteceu? Houve um problema de rede. E não tem jeito. Se tem uma coisa que a gente tem absoluta certeza é que em algum momento você vai poder ter esse problema de rede. É inevitável, tá? E aí o que acontece? Como o produtor tentou mandar, teve esse probleminha de rede, etc. O que que aconteceu? Ele foi e enviou essa mensagem novamente. e recebeu o Acknowledge. Porém, o que que acontece? Aquela mensagem que ficou lá, ali na rede, que teve aquele problema, houve um retry de alguma forma. A mensagem acabou indo também. E aí, o que que acontece? Mensagem duplicada. Então, o que que acontece? A mensagem 4, ela pode ter ido mais do que uma vez. Exatamente por esse tipo de situação. Nesse caso, quando a gente acontece esse tipo de situação, a gente pode dizer que o produtor indepotente aqui, a indepotência é off. O que isso significa? Significa que se acontece isso, duplica mesmo e abraça que dói menos. O grande ponto é o seguinte, nesse caso, ele vai gravar a mensagem 4 duplicada, e o consumer vai ler a mensagem duas vezes. Ponto. É o que vai acontecer. E aí a culpa não é do Kafka, é do produtor que mandou a mensagem duas vezes. Entende? O produtor mandou a mensagem duas vezes. De uma forma ou de outra, é isso que o Kafka acabou entendendo. Porém, o grande ponto aqui é como que a gente consegue evitar esse tipo de problema. E, de uma certa forma, é um baita problema. Então, nesse tipo de caso, a gente tem algo que a gente chama de produtor indepotente. O grande ponto aqui é o seguinte. Quando a gente fala que o produtor é indepotente, a gente manda a mensagem que pode acontecer exatamente aquela situação. o Kafka ele vai se ligar que isso aconteceu e ele vai descartar uma das mensagens. Então é algo que gera mais como que eu posso dizer mais lentidão Mas o Kafka ele consegue descartar a mensagem e também ao mesmo tempo ele consegue garantir que aquela mensagem caia na ordem correta ainda. Porque ele tem os timestamps. Então ele consegue fazer todo esse esquema aí pra gente trabalhar. Então a gente consegue trabalhar com essa tal da indepotência. Então se você tiver com o modo indepotência on você também garante mesmo que você mandando a mensagem duas vezes, o Kafka vai conseguir fazer esse descarte automaticamente. Então esse é mais um detalhe super importante. E no nosso próximo vídeo a gente vai começar a falar alguns pontos de quem? Do consumer! Chega de falar muito tempo aí de produtor, de producer, quantas entregas, media potência e tudo mais. Vamos falar agora um pouco mais sobre o consumidor. Vamos nessa!