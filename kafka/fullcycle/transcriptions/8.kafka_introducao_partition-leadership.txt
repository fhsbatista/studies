Olá pessoal, tudo bem? No nosso vídeo anterior a gente falou um pouco mais sobre essa distribuição nos dados das nossas partições e talvez você deva ter ficado com uma dúvida. Ok Wesley, mas o broker caiu, eu tenho uma cópia, mas uma coisa é ter uma cópia, outra coisa é garantir alta disponibilidade. Como que isso é possível? Então vamos falar um pouquinho disso, né? Vídeo bem rápido, mas pra explicar isso um pouquinho no detalhe, como é que essa parada funciona. Seguinte, No Kafka a gente tem algo que a gente chama de Partition Leadership, ou seja, liderança das partições. Então vamos imaginar aqui que eu tenho o broker A, B, C e D. E você vai ver aqui que eu tenho essas partições que estão em azul aqui pra mim. Então olhem bem as que são em azul. O que que significa essas partições em azul? Essas partições em azul são as partições chamadas de leaders. O que que isso significa? Significa o seguinte, quando o consumidor vai ler um tópico, e esse consumidor ele vai ter que ler, por exemplo, a partição 1, necessariamente ele vai ler a partição líder, tá? Então vamos ver aqui, por exemplo, a partição 1, aqui nesse caso, tá tanto no broker A quanto no broker B. Mas quando o consumidor for ler, não tem chance nenhuma, absolutamente nenhuma, De uma hora o consumidor lê às vezes do broker A ou às vezes do broker B. Never. O que vai acontecer vai ser o seguinte. Ele sempre vai ler da partição líder. Ok? Então isso aí é um ponto importante. Eu posso ter 10 cópias dessas partições dos meus brokers. Ok? Em diversos brokers. O grande ponto é o consumidor sempre vai ler a partição líder. Aí Pra que que então tem as outras cópias? Porque daí a gente cai na seguinte situação. O broker A caiu inteiro. Na hora que o broker cair, o que que vai acontecer? O Kafka vai perceber que ele caiu, tá? Muitas vezes com a ajuda do Zookeeper, vai depender do momento que tá acontecendo isso aqui. Mas o que que acontece? Ele vai ver que o broker A caiu, então ele vai falar o seguinte, opa, esse cara caiu. Quais eram as partições que esse cara tinha ali com ele? Ah, tinha a partição 1 das sales. Qual outro local, qual outro broker que eu tenho essa partição 1? Ele fala, ah, essa partição eu tenho uma cópia dela no broker B. Então ok, a partir desse momento o broker B vira um líder e não mais um follower. Então a gente tem as partições do tipo líder e do tipo follower. A líder é a que sempre vai ser lida. O follower é a partição reserva. quando o broker cair e a partição líder não conseguir ser lida o Kafka vai fazer ali o sorteio vai se organizar e vai falar a partir de agora meu amigo você é escolhida para que os caras consigam consumir legal então essa que é a que é essa que é a grande sacada de como todas essas coisas funcionam então a partir daí você já começa a pensar aqui poxa vida então se eu tiver diversos brokers e esses brokers tiverem na realidade diversas partições espalhadas Não tem problema eu ter downtime em alguns brokers, porque eu sempre vou ter essas cópias dessas partições e o Kafka sempre vai deixar disponível. E o mais louco é que isso acontece assim ó, muito rápido. Caiu aquele cara, na hora o Kafka já tá disponibilizando o outro pra ser lido com a partição ali pra ele. Então essa parte é muito interessante para que você precise realmente entender em relação a essa parte de Partition Leadership. Então fica ligado porque é realmente importante. E eu espero que você esteja gostando até agora. É um assunto bem denso mas me encanta muito a beleza de como tudo isso foi arquitetado. Então vamos seguir em frente porque a gente tem mais coisa ainda pra ver. Olá pessoal, tudo bem? A gente já entendeu a ideia básica sobre um tópico, sobre as partições, sobre as keys, a anatomia de um tópico, como que as partições são distribuídas, leaders, followers e etc. Mas agora a gente vai começar a entrar nos detalhes em relação a como que um producer manda uma mensagem e como que eu consigo garantir que realmente essa mensagem foi entregue. Eu não sei se já tinha passado isso pela sua cabeça, mas como que eu garanto? como que eu tenho certeza que aquela minha mensagem foi entregue? então mais.