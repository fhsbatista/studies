Olá pessoal, tudo bem? No vídeo anterior a gente falou um pouco sobre a dinâmica de funcionamento do Kafka, mas obviamente numa visão bem em alto nível. Agora a gente tem que começar a entender como é que funciona esse envio dessa mensagem, por onde que ele envia, como é que essas coisas funcionam. Então vamos começar a dar um zoom pra gente entender esses conceitos super importantes que o Kafka tem aí pra gente. Legal? então vamos lá meu povo a gente vai começar a falar agora aqui sobre tópicos tá ou topic que é muito comum você a ver por aí na toda a parte literatura inglês quando a gente tá falando sobre cáfrica é topic tá eu tô escrevendo em português mas saiba que quando a gente for ver se você for ver algum tutorial qualquer coisa assim é top legal O que é um tópico? Um tópico é o canal de comunicação responsável por receber e disponibilizar os dados enviados pro Kafka. Então quando eu tô falando com um produtor pra enviar uma mensagem pro broker, essa mensagem vai ser enviada para um tópico. É assim que a gente chama. Wesley, tópico é a mesma coisa que fila. Eu acho que quem tá acostumado com o RabbitMQ da vida, o RabbitMQ a gente tem fila, tem as exchanges, então somente pra você entender. Não. O Kafka não trabalha igual ao RabbitMQ, por exemplo. O RabbitMQ você tem várias filas plugadas numa exchange para as mensagens serem roteadas. O Kafka não trabalha dessa forma. As filas, entre aspas, do RabbitMQ é mais ou menos como se fossem os tópicos do Kafka. Então você quer mandar uma mensagem, você vai mandar essa mensagem para um tópico. E quando um consumidor quiser ler as mensagens, o que ele vai fazer? Ele vai ler essas mensagens, adivinha de onde? De um tópico. Então o tópico é o local onde a gente envia as mensagens. Show de bola? Então vamos lá. Eu tenho meu producer. Eu tenho o Kafka, eu tenho um consumer, e eu tenho um outro consumer. Eu posso ter diversos sistemas lendo, inclusive, o mesmo tópico. Então, eu vou mandar uma mensagem para um tópico, o consumidor 1 está lendo esse tópico, o consumidor 2 também está lendo esse tópico. Entendeu? Então, isso aí é um ponto importante para você entender. Eu posso ter um tópico e esse tópico pode ser lido por quantos sistemas eu quiser. É diferente do RabbitMQ que uma vez que alguém lê a mensagem em uma fila... UOU! Foi embora esse cara, né? Não dá pra você pegar dois sistemas lendo exatamente a mesma mensagem na mesma fila. Quando um leu... E der um hack na mensagem, a mensagem vai embora, o outro cara não consegue ler. No caso do Kafka, eu posso ter diversos sistemas diferentes, lendo o mesmo tópico, e as mensagens, entre aspas, podem ser lidas pra esses mesmos caras. Então, por exemplo, eu mandei a mensagem ABC pro tópico, o consumer 1 vai ler a mensagem ABC, o consumer 2 também vai ler a mensagem ABC. Ok? Isso que você tem que entender. Não tem essa... Ah, aquele cara leu primeiro, o outro não vai receber. Não. Eles conseguem ler. Legal? Então isso aí é um ponto importantíssimo pra você entender. Agora uma coisa que também é importante você entender é que como que funciona o tal do tópico ali no Kafka. O tópico é mais ou menos como se fosse um log. O que é um log no final das contas? É um local onde você pega uma informação e vai colocando uma atrás da outra. Isso é um log. Então, olha só que interessante. Vamos imaginar que eu tenho aí um tópico de vendas, legal? E você já leu uma palavrinha ali, inclusive, chamada partição do tópico de vendas. Segura a onda com essa palavra partição, porque a gente vai ouvir bastante essa palavra por aí, legal? Vamos lá. O que acontece aqui? Cada mensagem que a gente enviar, tá? Para um tópico, essa mensagem vai sendo armazenada, uma atrás da outra. Legal? E essa mensagem, quando ela é armazenada, ela ganha como se fosse uma espécie de um ID, que a gente chama de offset, tá? Então, o registro 0, o registro 1, o registro 2, o registro 3, até o infinito. Legal? Então eu tenho esse offset que é o local a posição basicamente onde tá cada mensagem. Então o primeiro offset é o zero. E aqui o que pode acontecer? Vamos imaginar que eu tenho dois consumidores. Pode ser que em um momento o consumidor A tá lendo ali a mensagem 3 e o consumidor B tá lendo ali a mensagem 7. está sendo nesse momento adicionado uma nova mensagem ali no final do log. Então não tem problema nenhum de um consumidor estar mais adiantado que o outro na leitura. Inclusive pode ser que um consumidor comece a ler uma mensagem hoje e o outro comece a ler essa mensagem daqui 10 dias. Não tem problema nenhum. o Kafka vai estar lá servindo as mensagens da mesma forma, tá? Então isso aí é um ponto importante. Inclusive, o Kafka, ele permite com que a gente consiga reprocessar essas mensagens. Vamos imaginar que a PPA começou a ler as mensagens e ela falou, sabe aquela mensagem número 2 que eu li? Eu tinha um bug no meu sistema e eu não consegui processar ela direito. eu vou fazer o seguinte Kafka eu quero voltar naquele tópico no offset 2 por favor ele vai lá e como se fosse rebobinar uma fita volta lá na mensagem 2 e ele consegue ler novamente uma mensagem tá então pensa que o tópico tem o log dele As mensagens são enfileradas e elas ficam armazenadas. Elas não ficam na memória. Por exemplo, o RabbitMQ trabalha muito com memória, né? O Kafka, ele salva em disco essas mensagens. E essas mensagens, elas podem ser lidas e relidas por um ou pelo mesmo sistema. Legal? Então, essa que é a ideia principal aí quando a gente tá falando sobre log. Legal? Agora o grande ponto de tudo isso é o seguinte, é que esse registrinho, pensa o offset 0, 1, 2 ali da mensagem, ele tem todo um esquema para quando a gente mandar a mensagem o Kafka conseguir entender e que o consumidor consiga ler e saber entender o que que tem naquele registro que ele tá lendo do Kafka. E o que a gente vai fazer? No nosso próximo vídeo a gente vai aprender exatamente isso. Como que é a anatomia de um registro, de uma mensagem que fica guardado ali no Kafka. Então vamos lá, até o nosso próximo vídeo.