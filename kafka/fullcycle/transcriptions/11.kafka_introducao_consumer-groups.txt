Olá pessoal, tudo bem? Agora a gente vai falar agora sobre consumer. É isso mesmo, a gente vai falar sobre os consumers e como que esses caras também têm esse papel no Kafka. A gente entendeu como que o Kafka funciona, como que as mensagens são enviadas para o Kafka. Agora a gente vai entender a dinâmica de como que os consumidores trabalham aí nesse nosso caso. Vamos nessa. Seguinte, Consumers. Então eu tenho o meu produtor, eu tenho o meu tópico que é a partição 0, 1 e 2 e aí eu tenho o meu consumidor. O que que acontece? Quando eu mando a mensagem, o meu consumidor vai ter que ler, nesse meu caso, na partição 0, na 1 e na 2. Porque eu tenho apenas um consumidor. Então, essa dinâmica é extremamente importante. Porque às vezes a gente fica pensando, poxa Wesley, eu tenho 5 partições, mas eu só tenho 1 consumidor. O que será que vai acontecer? Vai dar problema? Ele só vai ficar lendo de uma partição? Não. O que vai acontecer é, você tem um monte de partição, você tem um consumidor, na prática em relação a velocidade de processamento de mensagem não vai mudar nada porque no final das contas você tem apenas um cara e ele vai ter que processar todas as mensagens então isso aí é um fato aqui que a gente tem por outro lado A gente pode ter uma sensação, um ponto muito importante e é isso que eu quero que você preste atenção. Que é algo que a gente chama de Consumer Groups. Ou seja, grupos de consumidores. E preste muito bem atenção nessa parte. É muito importante mesmo. seguinte eu mandei a mensagem eu tenho três partições e aí eu tenho um grupo eu vou chamar esse grupo de x tá e o grupo x aqui nesse grupo x eu tenho o consumer a e o consumer b legal então o que que o consumirá o que que o consumer b Consumer A e Consumer B pode ser exatamente o mesmo software, rodando em máquinas diferentes, ou em processos diferentes. Eles fazem a mesma coisa. Já que eles fazem a mesma coisa, eu vou colocá-los dentro do mesmo grupo. E na hora que eu coloco esses caras dentro do mesmo grupo, o que vai acontecer? A partição A vai ser lida pelo Consumer A, a partição 0 e 1 vai ser lida pelo Consumer A, e a partição 2 vai ser lida pelo consumidor B aqui nesse caso. Então quando eu tenho um grupo de consumidores e eu falo que os consumidores estão dentro de um grupo Aí a coisa muda de figura. Por quê? Porque daí, esses consumidores, o Kafka consegue ajeitar para que os consumidores consigam fazer o bem bolado ali das leituras da partição. Agora eu vou dizer uma coisa. Se eu tivesse, por exemplo, um consumer C, um consumer Y, eu não quero nem falar C para não misturar, um consumer Y, e ele não estivesse no grupo X, esse consumer y ia tá lendo a partição 0 1 e 2 tá só tá vendo a leitura a partição 0 e 1 por um consumer e a 2 pelo consumer B, porque eles estão no mesmo grupo. Se não tiver grupo, basicamente o Kafka trata que o próprio consumidor é o próprio grupo. Ou seja, só tem um no mesmo grupo dele. Então ele vai ler de todas as partições. Então a coisa mais comum do mundo mesmo, quando você está trabalhando com o Kafka, na hora de você consumir, você falar qual é o grupo que você está consumindo. Porque daí todo mundo que estiver no mesmo grupo vai ser distribuído para ler de partições diferentes para conseguir ter uma melhor performance nessas leituras. Então, olha só que interessante também aqui. Eu posso ter, nesse momento, o meu grupo X, agora, com três consumidores. Então, olha só o que vai acontecer. Agora, cada consumidor lê uma partição. E, nesse caso, eu tenho o melhor dos mundos, né? Porque... é... cada cara tá lendo de um, então eu tenho a melhor performance, né? Tá todo mundo bonitinho. E daí, com certeza, eu sei que já deve ter passado aí pela sua cabeça. Wesley, mas e se eu adicionar Mais um cara aqui. O que vai acontecer? Sabe o que vai acontecer? Nada. Ele vai ficar idle. Ele vai ficar parado. Não tem como dois consumidores que estão no mesmo grupo lerem a mesma partição. Legal? É sempre um consumer por partição. não tem como dois consumers no mesmo grupo lerem a mesma partição. O que pode acontecer é eu ter dois consumers em grupos diferentes, esses caras, sim, vão poder ler a mesma partição, porque eles estão em grupos diferentes. Agora, dentro de um mesmo grupo, cada consumer lê sempre uma partição no maço. Se tiver mais consumer do que partição, os consumers, o consumer vai ficar parado ali sem ler nada enquanto isso. Então isso aí é extremamente importante porque já deu pra perceber que não adianta sair criando um monte de partição se você tem pouco consumer, porque seus consumers vão ter que sair lendo um monte de partição, mas também não adianta encher de um monte de consumer Se a quantidade de consumers que você tem é maior do que a quantidade de partições, então o melhor dos mundos é sempre você ter a mesma quantidade de partições ser a mesma quantidade de consumidores. Se for menos, alguém vai ficar mais supercarregado se for mais alguém vai ficar parado então isso aí é um ponto importantíssimo tá coloque bem na sua cabeça tá trabalhar com grupos de consumo é assim muito comum né você sempre vai ter que citar se você não falar qual é o seu grupo O grupo tá sendo o próprio consumidor. É um grupo de um. Sabe aquele usuário? Eu tenho um usuário Wesley. Qual que é o grupo do Wesley? Ah, não tem grupo. Então o nome do grupo é ele mesmo. Entendeu? Então o Wesley tem um grupo Wesley, onde ele tem as permissões do grupo, porque o Wesley faz parte do próprio grupo dele. Então é mais ou menos essa pegada aqui. Então preste bem atenção, assista novamente esse vídeo se você achar necessário, mas tente entender esse raciocínio porque realmente faz muita diferença lá na frente se você não entender. Fechou? Grande abraço e até o nosso próximo vídeo.